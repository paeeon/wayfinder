{"version":3,"sources":["scripts/app-efc717e8db.js"],"names":["angular","module","querybox","MapFactory","restrict","scope","templateUrl","link","defaultBounds","google","maps","LatLngBounds","LatLng","input","document","getElementById","options","bounds","types","componentRestrictions","country","autocomplete","places","Autocomplete","addListener","placeResult","getPlace","getStart","getEnd","setPlace","setRouteCap","name","geometry","location","formatted_address","element","css","value","placeholder","$watch","routeHasBeenCalculated","newVal","routeCalculated","$inject","directive","placesToCheckOut","isReadonly","querySelector","heightCalc","offsetHeight","toString","getPlaces","highlightPlace","place","placeMarker","getMapMarkers","markerPosition","openInfoWindow","acmeNavbar","NavbarController","moment","vm","this","relativeDate","creationDate","fromNow","controller","controllerAs","bindToController","markerlist","start","end","PlaceFactory","lodash","$q","chunkPathArr","a","n","balanced","size","len","length","out","i","Math","floor","push","slice","ceil","determineNumOfChunks","num","placeTypes","fac","getPlacesAlongRoute","placeService","routesObj","placePromises","promisifier","requestObj","resolve","reject","nearbySearch","results","status","PlacesServiceStatus","OK","console","error","tripDistance","legs","distance","numChunks","chunkedPathArr","overview_path","forEach","chunk","middle","request","radius","rankBy","RankBy","PROMINENCE","all","factory","$rootScope","map","directionsDisplay","mapMarkers","directionsService","DirectionsService","mapStyleArr","featureType","elementType","stylers","visibility","lightness","color","initMap","DirectionsRenderer","Map","zoom","center","lat","lng","mapTypeId","MapTypeId","ROADMAP","disableDefaultUI","styles","PlacesService","setMap","fitMapToBounds","position","extend","fitBounds","calculateRoute","origin","getPosition","destination","travelMode","TravelMode","DRIVING","route","result","DirectionsStatus","setDirections","routes","then","arrOfPlaceArrays","placeArr","initiateMap","getMap","removeMapMarker","idx","splice","$applyAsync","clearMapMarkers","marker","createMarker","title","latLngObj","address","Marker","infowindow","InfoWindow","content","open","mapMarker","close","setCenter","placeObj","vicinity","photos","photoUrl","getUrl","maxWidth","maxHeight","startLocation","MainController","runBlock","run","routerConfig","$stateProvider","$urlRouterProvider","state","url","otherwise","config","$logProvider","toastrConfig","debugEnabled","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","$templateCache","put"],"mappings":"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","file":"scripts/app-efc717e8db.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder', ['ngAnimate', 'ngCookies', 'ngTouch', 'ngSanitize', 'ngMessages', 'ngAria', 'ui.router', 'ui.bootstrap', 'toastr', 'ngLodash']);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .directive('querybox', querybox);\n\n  /** @ngInject **/\n  function querybox(MapFactory) {\n    return {\n      restrict: 'E',\n      scope: {},\n      templateUrl: 'app/components/querybox/querybox.html',\n      link: function(scope) {\n\n        // Set the default bounds for the searchBox\n        var defaultBounds = new google.maps.LatLngBounds(\n          new google.maps.LatLng(53.861378, -129.453106),\n          new google.maps.LatLng(22.568883, -63.585954));\n\n        // Pre-fill the input and options, to be passed in as arguments when\n        // creating the Autocomplete object on line 22\n        var input = document.getElementById('query-field');\n        var options = {\n          bounds: defaultBounds,\n          types: ['establishment'],\n          componentRestrictions: {\n            country: 'us'\n          }\n        };\n\n        var autocomplete = new google.maps.places.Autocomplete(input, options);\n\n        autocomplete.addListener('place_changed', function() {\n          var placeResult = autocomplete.getPlace();\n\n          if (MapFactory.getStart() && MapFactory.getEnd()) {\n            MapFactory.setPlace(placeResult);\n          } else {\n            if (MapFactory.getStart()) {\n              MapFactory.setRouteCap(placeResult.name, placeResult.geometry.location, placeResult.formatted_address, false);\n              angular.element(input).css('display', 'none');\n            } else {\n              MapFactory.setRouteCap(placeResult.name, placeResult.geometry.location, placeResult.formatted_address, true);\n              input.value = '';\n              input.placeholder = 'Enter your ending address…';\n            }\n          }\n        });\n\n        scope.$watch(MapFactory.routeHasBeenCalculated, function(newVal) {\n          if (newVal) {\n            scope.routeCalculated = true;\n          }\n        });\n\n      }\n    };\n  };\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .directive('placesToCheckOut', placesToCheckOut);\n\n  /** @ngInject **/\n  function placesToCheckOut(MapFactory) {\n    return {\n      restrict: 'E',\n      scope: {},\n      templateUrl: 'app/components/placesToCheckout/placesToCheckOut.html',\n      link: function(scope, element) {\n\n        // uib rating variable\n        scope.isReadonly = true;\n\n        scope.$watch(MapFactory.routeHasBeenCalculated, function(newVal) {\n          if (newVal) {\n            var querybox = document.querySelector('#querybox-title');\n            var heightCalc = 'calc(100vh - ' + querybox.offsetHeight.toString() + 'px)';\n            element.css('height', heightCalc);\n            scope.places = MapFactory.getPlaces();\n          }\n        });\n\n        scope.highlightPlace = function(place) {\n          var placeMarker = MapFactory.getMapMarkers()[place.markerPosition];\n          MapFactory.openInfoWindow(placeMarker);\n        };\n\n      }\n    };\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .directive('acmeNavbar', acmeNavbar);\n\n  /** @ngInject */\n  function acmeNavbar() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/navbar/navbar.html',\n      scope: {\n          creationDate: '='\n      },\n      controller: NavbarController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function NavbarController(moment) {\n      var vm = this;\n\n      // \"vm.creation\" is avaible by directive option \"bindToController: true\"\n      vm.relativeDate = moment(vm.creationDate).fromNow();\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .directive('markerlist', markerlist);\n\n  /** @ngInject **/\n  function markerlist(MapFactory) {\n    return {\n      restrict: 'E',\n      scope: {},\n      templateUrl: 'app/components/markerlist/markerlist.html',\n      link: function(scope) {\n        var unbindStart = scope.$watch(MapFactory.getStart, function(newVal) {\n          if (newVal) {\n            scope.start = newVal;\n            // unbindStart();\n          }\n        });\n\n        var unbindEnd = scope.$watch(MapFactory.getEnd, function(newVal) {\n          if (newVal) {\n            scope.end = newVal;\n            // unbindEnd();\n          }\n        });\n      }\n    };\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .factory('PlaceFactory', PlaceFactory);\n\n  /** @ngInject **/\n  function PlaceFactory(lodash, $q) {\n\n    var determineNumOfChunks = function(num) {\n      if (num <= 50000) return 2;\n      else if (num > 50000 && num <= 1500000) return 4;\n      else if (num > 1500000) return 5;\n    }\n\n    // Chunk the number of requests to make to Yelp's API based on how far the trip is\n    function chunkPathArr(a, n, balanced) {\n      if (n < 2)\n        return [a];\n\n      var len = a.length,\n        out = [],\n        i = 0,\n        size;\n\n      if (len % n === 0) {\n        size = Math.floor(len / n);\n        while (i < len) {\n          out.push(a.slice(i, i += size));\n        }\n      } else if (balanced) {\n        while (i < len) {\n          size = Math.ceil((len - i) / n--);\n          out.push(a.slice(i, i += size));\n        }\n      } else {\n        n--;\n        size = Math.floor(len / n);\n        if (len % size === 0)\n          size--;\n        while (i < size * n) {\n          out.push(a.slice(i, i += size));\n        }\n        out.push(a.slice(size * n));\n      }\n      return out;\n    }\n\n    var placeTypes = [\n      'amusement_park',\n      'aquarium',\n      'art_gallery',\n      'campground',\n      'museum',\n      'shopping_mall',\n      'zoo'\n    ];\n\n    var fac = {\n      getPlacesAlongRoute: function(placeService, routesObj) {\n        var places = [];\n        var placePromises = [];\n\n        var promisifier = function(requestObj) {\n          return $q(function(resolve, reject) {\n            placeService.nearbySearch(requestObj, function(results, status) {\n              if (status == google.maps.places.PlacesServiceStatus.OK) {\n                resolve(results);\n              } else {\n                console.error(status);\n                reject(status);\n              }\n            })\n          });\n        }\n\n        var tripDistance = routesObj.legs[0].distance.value;\n        var numChunks = determineNumOfChunks(tripDistance);\n        var chunkedPathArr = chunkPathArr(routesObj.overview_path, numChunks, true);\n        chunkedPathArr.forEach(function(chunk) {\n          var middle = chunk[Math.floor((chunk.length - 1) / 2)];\n          var request = {\n            location: middle,\n            radius: (tripDistance / numChunks)/2,\n            types: placeTypes,\n            rankBy: google.maps.places.RankBy.PROMINENCE\n          };\n          placePromises.push(promisifier(request));\n        });\n        return $q.all(placePromises);\n      }\n    };\n\n    return fac;\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .factory('MapFactory', MapFactory);\n\n  /** @ngInject **/\n  function MapFactory($rootScope, PlaceFactory) {\n    var map;\n    var start;\n    var end;\n    var mapMarkers = [];\n    var bounds = new google.maps.LatLngBounds();\n    var directionsService = new google.maps.DirectionsService();\n    var places = [];\n    var placeService;\n    var directionsDisplay;\n    var routeCalculated = false;\n    var mapStyleArr = [{\n      \"featureType\": \"administrative\",\n      \"elementType\": \"all\",\n      \"stylers\": [{\n        \"visibility\": \"on\"\n      }, {\n        \"lightness\": 33\n      }]\n    }, {\n      \"featureType\": \"landscape\",\n      \"elementType\": \"all\",\n      \"stylers\": [{\n        \"color\": \"#f2e5d4\"\n      }]\n    }, {\n      \"featureType\": \"poi.park\",\n      \"elementType\": \"geometry\",\n      \"stylers\": [{\n        \"color\": \"#c5dac6\"\n      }]\n    }, {\n      \"featureType\": \"poi.park\",\n      \"elementType\": \"labels\",\n      \"stylers\": [{\n        \"visibility\": \"on\"\n      }, {\n        \"lightness\": 20\n      }]\n    }, {\n      \"featureType\": \"road\",\n      \"elementType\": \"all\",\n      \"stylers\": [{\n        \"lightness\": 20\n      }]\n    }, {\n      \"featureType\": \"road.highway\",\n      \"elementType\": \"geometry\",\n      \"stylers\": [{\n        \"color\": \"#c5c6c6\"\n      }]\n    }, {\n      \"featureType\": \"road.arterial\",\n      \"elementType\": \"geometry\",\n      \"stylers\": [{\n        \"color\": \"#e4d7c6\"\n      }]\n    }, {\n      \"featureType\": \"road.local\",\n      \"elementType\": \"geometry\",\n      \"stylers\": [{\n        \"color\": \"#fbfaf7\"\n      }]\n    }, {\n      \"featureType\": \"water\",\n      \"elementType\": \"all\",\n      \"stylers\": [{\n        \"visibility\": \"on\"\n      }, {\n        \"color\": \"#acbcc9\"\n      }]\n    }];\n\n    var initMap = function() {\n      directionsDisplay = new google.maps.DirectionsRenderer();\n      map = new google.maps.Map(document.getElementById('map'), {\n        zoom: 4,\n        center: {\n          lat: 40.207518,\n          lng: -97.198190\n        },\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\n        disableDefaultUI: true,\n        styles: mapStyleArr\n      });\n      placeService = new google.maps.places.PlacesService(map);\n      directionsDisplay.setMap(map);\n    };\n\n    var fitMapToBounds = function(position) {\n      bounds.extend(position);\n      map.fitBounds(bounds);\n    };\n\n    var sortArrayByRatingDescending = function(a, b) {\n      if (a.rating < b.rating) return -1;\n      else if (a.rating > b.rating) return 1;\n      else return 0;\n    }\n\n    var calculateRoute = function(start, end) {\n      var requestObj = {\n        origin: start.getPosition(),\n        destination: end.getPosition(),\n        travelMode: google.maps.TravelMode.DRIVING\n      };\n      directionsService.route(requestObj, function(result, status) {\n        if (status == google.maps.DirectionsStatus.OK) {\n          directionsDisplay.setDirections(result);\n\n          return PlaceFactory.getPlacesAlongRoute(placeService, result.routes[0])\n            .then(function(arrOfPlaceArrays) {\n              var placesToMap = [];\n              arrOfPlaceArrays.forEach(function(placeArr) {\n                fac.setPlace(placeArr[0]);\n              });\n              routeCalculated = true;\n            }).then(null, console.error);\n        }\n      });\n    };\n\n    var fac = {\n      initiateMap: function() {\n        return initMap();\n      },\n      getMap: function() {\n        return map;\n      },\n      removeMapMarker: function(idx) {\n        mapMarkers.splice(idx, 1);\n        $rootScope.$applyAsync();\n      },\n      clearMapMarkers: function() {\n        mapMarkers.forEach(function(marker) {\n          marker.setMap(null);\n        });\n        mapMarkers = [];\n      },\n      getStart: function() {\n        return start;\n      },\n      getEnd: function() {\n        return end;\n      },\n      getMapMarkers: function() {\n        return mapMarkers;\n      },\n      getPlaces: function() {\n        return places;\n      },\n      routeHasBeenCalculated: function() {\n        return routeCalculated;\n      },\n      createMarker: function(title, latLngObj, address) {\n        var marker = new google.maps.Marker({\n          position: latLngObj,\n          map: map,\n          title: title,\n          address: address\n        });\n\n        var infowindow = new google.maps.InfoWindow({\n          content: '<div class=\"info-window\">' + '<h3 class=\"info-title\">' +\n            title + '</h3>' + '<p class=\"info-description\">' + address + '</p>' + '</div>'\n        });\n\n        marker.infowindow = infowindow;\n\n        marker.addListener('click', function() {\n          infowindow.open(map, marker);\n        });\n\n        marker.setMap(map);\n        mapMarkers.push(marker);\n\n        return marker;\n      },\n      openInfoWindow: function(marker) {\n        // Close all currently open infowindows\n        mapMarkers.forEach(function(mapMarker) {\n          mapMarker.infowindow.close();\n        })\n\n        map.setCenter(marker.getPosition());\n        marker.infowindow.open(map, marker);\n      },\n      setPlace: function(placeObj) {\n        var marker = this.createMarker(placeObj.name, placeObj.geometry.location, placeObj.vicinity);\n\n        mapMarkers.push(marker);\n\n        if (placeObj.photos) {\n          placeObj.photoUrl = placeObj.photos[0].getUrl({'maxWidth': 300, 'maxHeight': 300});\n        }\n        placeObj.markerPosition = mapMarkers.length - 1;\n\n        places.push(placeObj);\n      },\n      setRouteCap: function(title, latLngObj, address, startLocation) {\n        var marker = this.createMarker(title, latLngObj, address);\n\n        if (startLocation) {\n          start = marker;\n        } else {\n          end = marker;\n        }\n\n        if (start && end && !routeCalculated) {\n          calculateRoute(start, end);\n        }\n\n        fitMapToBounds(latLngObj);\n        $rootScope.$applyAsync();\n      }\n    };\n\n    return fac;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController(MapFactory) {\n    MapFactory.initiateMap();\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock() {\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'main'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wayfinder')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, toastrConfig) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 3000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = true;\n    toastrConfig.progressBar = true;\n  }\n\n})();\n\nangular.module(\"wayfinder\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<div id=\\\"map\\\"></div>\");\n$templateCache.put(\"app/components/markerlist/markerlist.html\",\"<ul class=\\\"marker-list list-group\\\"><li class=\\\"marker list-group-item clearfix\\\" ng-show=\\\"start\\\"><div class=\\\"marker-info pull-left\\\"><i class=\\\"fa fa-map-marker pull-left\\\"></i><p class=\\\"starting-with\\\">Starting at</p><p class=\\\"marker-title\\\">{{ start.title }}</p><p class=\\\"marker-address\\\">{{ start.address }}</p></div></li><li class=\\\"marker list-group-item clearfix\\\" ng-show=\\\"end\\\"><div class=\\\"marker-info pull-left\\\"><i class=\\\"fa fa-map-marker pull-left\\\"></i><p class=\\\"ending-with\\\">Ending at</p><p class=\\\"marker-title\\\">{{ end.title }}</p><p class=\\\"marker-address\\\">{{ end.address }}</p></div></li></ul>\");\n$templateCache.put(\"app/components/navbar/navbar.html\",\"<nav class=\\\"navbar navbar-static-top navbar-inverse\\\"><div class=\\\"container-fluid\\\"><div class=\\\"navbar-header\\\"><a class=\\\"navbar-brand\\\" href=\\\"https://github.com/Swiip/generator-gulp-angular\\\"><span class=\\\"glyphicon glyphicon-home\\\"></span> Gulp Angular</a></div><div class=\\\"collapse navbar-collapse\\\" id=\\\"bs-example-navbar-collapse-6\\\"><ul class=\\\"nav navbar-nav\\\"><li class=\\\"active\\\"><a ng-href=\\\"#\\\">Home</a></li><li><a ng-href=\\\"#\\\">About</a></li><li><a ng-href=\\\"#\\\">Contact</a></li></ul><ul class=\\\"nav navbar-nav navbar-right acme-navbar-text\\\"><li>Application was created {{ vm.relativeDate }}.</li></ul></div></div></nav>\");\n$templateCache.put(\"app/components/placesToCheckout/placesToCheckOut.html\",\"<h2 class=\\\"place-list-header\\\"><i class=\\\"fa fa-map-signs\\\"></i>You should check out…</h2><ul class=\\\"place-list list-group\\\"><li class=\\\"place list-group-item clearfix\\\" ng-repeat=\\\"place in places\\\" ng-click=\\\"highlightPlace(place)\\\"><div class=\\\"place-pic pull-left\\\" ng-show=\\\"place.photoUrl\\\"><img ng-src=\\\"{{ place.photoUrl }}\\\"></div><div class=\\\"place-info\\\"><p class=\\\"place-title\\\">{{ place.name }}</p><p class=\\\"place-address\\\">{{ place.vicinity }}</p><uib-rating ng-model=\\\"place.rating\\\" read-only=\\\"isReadonly\\\"></uib-rating></div></li></ul>\");\n$templateCache.put(\"app/components/querybox/querybox.html\",\"<div id=\\\"querybox-wrapper\\\"><div id=\\\"querybox-title\\\"><img class=\\\"logo\\\" src=\\\"assets/images/logo.png\\\"><h1 class=\\\"app-title\\\">WayFinder</h1><p class=\\\"slogan\\\">Find cool places to stop by on a road trip</p><markerlist></markerlist></div><input type=\\\"text\\\" id=\\\"query-field\\\" placeholder=\\\"Enter your starting address…\\\"><places-to-check-out ng-show=\\\"routeCalculated\\\"></places-to-check-out></div>\");}]);"],"sourceRoot":"/source/"}